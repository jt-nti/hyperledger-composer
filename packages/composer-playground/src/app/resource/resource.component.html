<div class="resource-modal">
  <div class="modal-header">
    <h1>{{resourceAction}} {{resourceType}}</h1>
    <button class="icon modal-exit" (click)="activeModal.close()">
      <svg class="ibm-icon" aria-hidden="true">
       <use xlink:href="#icon-close_new"></use>
      </svg>
    </button>
  </div>
  <section class="modal-body">

    <section class="resource-container">
      <section class="resource-component">
        <div><p class="resource-preview-text">Test Form</p></div>
        <div class="resource-form">
          <form [formGroup]="resourceForm" (ngSubmit)="onSubmit()" *ngIf="!complexDataStructure">
            <input hidden name="$class" type="text" formControlName="$class">
            <div class="resource-field" *ngFor="let property of resourceProperties;">
              <h3>{{property.name}}</h3>

              <input formControlName="{{property.name}}" type="input" name="{{property.name}}" *ngIf="property.type === 'String' || property.type === 'DateTime' || property.ast.type === 'RelationshipDeclaration'">
              <input formControlName="{{property.name}}" type="number" name="{{property.name}}" *ngIf="property.type === 'Integer' || property.type === 'Long'">
              <input formControlName="{{property.name}}" type="number" step="any" name="{{property.name}}" *ngIf="property.type === 'Double'">
              <input formControlName="{{property.name}}" type="checkbox" (ngValue)="$event.target.checked ? true : false" *ngIf="property.type === 'Boolean'">
              <select *ngIf="property.isTypeEnum() === true && property.options" formControlName="{{property.name}}">
                <option *ngFor="let option of property.options" (ngValue)="option.name">{{option.name}}</option>
              </select>

              <div *ngIf="property.ast.type !== 'RelationshipDeclaration' && property.nestedOptions">
                <div *ngFor="let option of property.nestedOptions; let i=index">
                  {{option.name}}
                  <div [formGroupName]="property.name">
                    <input formControlName="{{option.name}}" type="input" name="{{option.name}}" *ngIf="option.type === 'String' || option.type === 'DateTime' || option.ast.type === 'RelationshipDeclaration'">
                    <input formControlName="{{option.name}}" type="number" name="{{option.name}}" *ngIf="option.type === 'Integer' || option.type === 'Long'">
                    <input formControlName="{{option.name}}" type="number" step="any" name="{{option.name}}" *ngIf="option.type === 'Double'">
                    <input formControlName="{{option.name}}" type="checkbox" (ngValue)="$event.target.checked ? true : false" *ngIf="option.type === 'Boolean'">
                  </div>
                </div>
              </div>
            </div>
            <button type="submit">Submit Form</button>
          </form>
          <div *ngIf="complexDataStructure">
            <h2>Complex Data Type</h2>
            <p>We're not going to create a form</p>
          </div>
        </div>
      </section>
      <section class="resource-component">
      <div>
        <p class="resource-preview-text">JSON Data Preview</p>
      </div>
       <div class="resource-bound">
        <codemirror name="codeMirror" [(ngModel)]="resourceDefinition" [config]="codeConfig" (ngModelChange)="onDefinitionChanged()"
                    width="100%" height="100%" ngDefaultControl>
        </codemirror>
        <div class="resource-error-text" ng-if="definitionError!=null">
          <p>{{definitionError}}</p>
        </div>
      </div>
      </section>
    </section>
  </section>
  <footer>
    <p class="footer-text" *ngIf="!editMode()">Just need quick test data? <button type="button" class="icon" (click)="generateResource(true)"><u>Generate Random Data</u></button></p>
    <button type="button" class="secondary" (click)="activeModal.close();">
      <span>Cancel</span>
    </button>
    <button id="createResourceButton" type="button" class="primary" (click)="addOrUpdateResource()" [disabled]="definitionError!=null || actionInProgress ">
      <div *ngIf="!actionInProgress">
        <span>{{resourceAction}}</span>
      </div>
      <div *ngIf="actionInProgress" class="ibm-spinner-indeterminate small loop">
        <div class="loader">
          <svg class="circular" viewBox="25 25 50 50">
            <circle class="circle-path" cx="50" cy="50" r="20"/>
          </svg>
        </div>
      </div>
    </button>
  </footer>
</div>
